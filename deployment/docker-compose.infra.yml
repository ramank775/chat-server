version: "3.9"

networks:
  vartalap:

services:
  nginx:
    ports:
      - "8080:80"
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"

  redis:
    image: redis:7.2
    logging:
      options:
        max-size: "50m"
    networks:
      - vartalap

  ws-gateway:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  message-delivery:
    image: ramank775/chatserver:${CHAT_SERVER_TAG}
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  message:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  message-storage:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  channel:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  profile:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  notification:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure

  media-metadata-ms:
    networks:
      - vartalap
    logging:
      options:
        max-size: "100m"
    deploy:
      replicas: 1
      restart_policy:
        condition: on-failure